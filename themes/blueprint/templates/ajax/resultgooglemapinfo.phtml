<div class="mapInfoWrapper">
  <h2><?=$this->transEsc('map_results_label')?></h2>
  <div class="mapInfoResults">
    <? $i = 0; ?>
    <? foreach($this->recordSet as $record): ?>
    <? $i++; ?>
      <div class="mapInfoResult <? if ($i % 2 == 0): ?>alt <? endif; ?>record<?=$i ?>">
        <div class="mapInfoResultThumb">
          <? if ($thumb = $this->record($record)->getThumbnail()): ?><img class="mapInfoResultThumbImg" src="<?=$this->escapeHtmlAttr($thumb) ?>" style="display:block"/><? endif; ?>
        </div>

        <div class="mapInfoResultText">
        <a href="<?=$this->recordLink()->getUrl($record)?>"><?=($title = $record->getTitle()) ? $title : $this->transEsc('Title not available') ?></a>
        <? $authors = $record->getPrimaryAuthors(); if (!empty($authors)): ?>
          <br/><?=$this->transEsc('by')?>: <a href="<?=$this->record($record)->getLink('author', $authors[0])?>"><?=$this->escapeHtml($authors[0]);?></a><? if (count($authors) > 1): ?>, <?=$this->transEsc('more_authors_abbrev')?><? endif; ?>
        <? endif; ?>
        </div>

      </div>
      <div class="clearer"></div>
    <? if ($i == 5) break; ?>
    <? endforeach; ?>
  </div>
  <? if ($this->recordCount > 5): ?>
    <div class="mapSeeAllDiv">
      <a href="<?=$this->url('search-results') ?><?=$this->results->getUrlQuery()->getParams() ?>"><?=$this->transEsc('see all') ?> <?=$this->escapeHtml($this->recordCount) ?>...</a>
    </div>
  <? endif; ?>
</div>
